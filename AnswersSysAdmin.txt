


1. За да извадим всички IP адреси, които имат отворени връзки към порт 80 със статус ESTABLISHED, можем да използваме следната команда:

   " sudo netstat -tn | awk '$4 ~ /:80$/ && $6 == "ESTABLISHED" {print $5}' | sort | uniq -c | sort -nr" - for linux
   " Get-NetTCPConnection -RemotePort 80 -State 'Established' - wimdows

   Командата използва `netstat` за да покаже отворените връзки, след което `awk` се използва за да избере редовете, които имат порт 80 и статус ESTABLISHED. След това се използва `sort`, `uniq` и `sort` отново, за да се подредят по брой и да се сортират в обратен ред.

2. За да блокираме топ 5 IP адреси от резултата в задача 1, можем да използваме следната команда:

   ```
   for ip in $(sudo netstat -tn | awk '$4 ~ /:80$/ && $6 == "ESTABLISHED" {print $5}' | sort | uniq -c | sort -nr | head -n 5 | awk '{print $2}'); do
     sudo iptables -I INPUT -s $ip -j DROP
   done
   ```

   Командата използва `netstat`, `awk`, `sort`, `uniq`, `sort` и `head`, за да намери топ 5 IP адреси от резултата в задача 1. След това се използва `iptables` за да блокира входящите връзки от тези IP адреси.

3. За да извадим всички адреси достъпвали машината за определена дата от access лога на Apache, можем да използваме следната команда:

   ```
   sudo awk -v date="14/Jan/2023" '$4 ~ date {print $1}' /var/log/apache2/access.log | sort | uniq -c | sort -nr
   ```

   Командата използва `awk` за да избере редовете, които съдържат определената дата в лога на Apache. След това се използва `sort`, `uniq` и `sort` отново, за да се подредят по брой и да се сортират в обратен ред.

4. За да извадим Модел и Сериен номер на определен хард диск, можем да използваме следната команда:

   ```
   sudo hdparm -I /dev/sda | grep -E 'Model|Serial\ Number'
   ```

   Командата използва `hdparm` за да покаже информацията за хард диска, след което
   
   За да извадим модела и серийния номер на определен хард диск, можем да използваме командата `smartctl` с опция `-i` за да получим информацията за хардуера. След това можем да използваме `grep` и `awk` за да извлечем само необходимата информация. Командата би изглеждала по следния начин:


	smartctl -i /dev/sda | grep "Model\\|Serial" | awk '{print $NF}'
	

	Тук предполагаме, че хард диска, за който искаме информацията, е монтиран на `/dev/sda`. Командата ще изведе само модела и серийния номер на хард диска, като втората команда използва `grep` за да избере само редовете, съдържащи "Model" или "Serial". След това `awk` извлича последната дума от всеки от тези редове, което е стойността на модела или серийния номер на хард диска.

5. За да се проследят всички заявки към порт 80 с помощта на tcpdump и да се запишат във файл, може да се използва следната команда:
	```
	sudo tcpdump -i eth0 -n port 80 -s 0 -w http-traffic.pcap
	```
	Това записва пакетите, които минават през интерфейс "eth0" и са насочени към порт 80, във файл с име "http-traffic.pcap". За да се извадят топ 5 най-посещавани сайта и да се подредят в обратен ред, може да се използва командата "tshark":
	```
	tshark -r http-traffic.pcap -Y "http.request.method == GET" -T fields -e http.host | sort | uniq -c | sort -rn | head -n 5
	```
	Тази команда извлича имената на всички посетени сайтове от файла "http-traffic.pcap", ги сортира и извежда топ 5 най-посещавани сайта, сортирани в обратен ред по брой посещения.

6. За да се прехвърли база данни от един сървър на друг, като MySQL на втория не слуша на порт 3306, може да се използва команда на следния вид:
	```
	mysqldump -u <username> -p <password> <database_name> | ssh <user>@<host> mysql -u <username> -p <password> -h <host> <database_name>
	```
	Тази команда използва "mysqldump" за да направи резервно копие на базата данни от първия сървър и го изпраща чрез SSH към втория сървър, където базата данни се възстановява с помощта на командата "mysql".

7. За да се намерят и изтрият всички файлове, завършващи с "tar.gz", с максимална дълбочина 3 директории от текущата, може да се използва следната команда:
	```
	find . -maxdepth 3 -type f -name "*.tar.gz" -delete
	```
	Тази команда търси в текущата директория и до трето ниво на влагане (-maxdepth 3) всички файлове, завършващи на ".tar.gz" (-name "*.tar.gz") и ги изтрива (-delete).

8. Имаме следната ситуация: на mysql server цялата конзола зависва, сървърът ще забие. Как ще спрете mysqld:
	a) kill -9 <pid>
	b) killall mysqld
	c) /etc/init.d/mysqld stop 
	Аргументирайте отговора си.

	При избор на метод за спиране на mysqld трябва да се има предвид какъв е типът на зависването. Ако процесът на mysqld е забил и не реагира на сигнали за прекратяване, може да се използва опцията на командата kill -9 <pid>, която задължително ще прекрати процеса. Тази опция обаче може да доведе до загуба на данни, която може да се избегне, ако се използва първо опцията на kill без -9, която изпраща сигнал за прекратяване на процеса и дава възможност на mysqld да се прекрати по нормален начин и да съхранят своите данни. 
	Ако mysqld все още не реагира на командата за прекратяване, може да се използва опцията на kill -9 за задължително прекратяване на процеса. Ако обаче има други процеси на mysqld, които трябва да продължат да работят, или има други приложения, които ползват същия MySQL сървър, по-добре е да се използва опцията на /etc/init.d/mysqld stop, която ще спре MySQL сървъра по нормален начин и ще съхранят данните.